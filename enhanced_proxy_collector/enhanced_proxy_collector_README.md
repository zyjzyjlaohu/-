# 增强版代理收集工具

这是一个基于Fofa API的增强版代理收集工具，能够通过多种搜索语法自动收集更多可用的代理。

## 功能特点

1. **多语法搜索**：集成了多种搜索语法，包括原始SOCKS5无认证代理和用户提供的新语法
2. **去重处理**：自动去除重复的代理条目
3. **多层筛选**：先进行端口开放检测，再进行实际可用性测试
4. **多URL测试**：使用多个网站测试代理有效性，提高准确性
5. **认证支持**：尝试使用用户名和密码字典进行认证代理测试
6. **并发处理**：使用线程池提高处理速度
7. **统计报告**：生成详细的统计信息，包括代理总数、开放端口数和有效代理数

## 使用方法

1. 确保已安装必要的依赖：
```bash
pip install requests
```

2. 修改配置文件中的Fofa API凭证：
   在`enhanced_proxy_collector.py`文件中找到以下配置并修改为您自己的Fofa API凭证：
   ```python
   CONFIG = {
       "fofa_email": "your_email@example.com",
       "fofa_key": "your_fofa_api_key",
       # 其他配置...
   }
   ```

3. 准备用户和密码文件：
   - `user.txt`：包含可能的代理用户名，每行一个
   - `pass.txt`：包含可能的代理密码，每行一个

4. 运行工具：
   - 双击运行`运行增强版代理收集工具.bat`批处理文件
   - 或者在命令行中执行：
     ```bash
     python enhanced_proxy_collector.py
     ```

## 输出文件

工具运行后会生成以下输出文件：

- `enhanced_fofa_results.txt`：通过Fofa API搜索到的所有潜在代理
- `enhanced_open_ports.txt`：端口开放的代理列表
- `enhanced_valid_proxies.txt`：经过验证的有效代理列表

## 配置参数说明

在`enhanced_proxy_collector.py`文件中可以修改以下配置参数：

| 参数名 | 说明 | 默认值 |
|-------|------|-------|
| fofa_email | Fofa账号邮箱 | - |
| fofa_key | Fofa API密钥 | - |
| max_workers | 最大线程数 | 100 |
| connect_timeout | 端口连接超时时间(秒) | 3 |
| check_timeout | 代理验证超时时间(秒) | 5 |
| scan_ports | 要扫描的端口列表 | [80, 8080, 8888, 3128, 1080, 1081, 1090, 5555, 7777, 9999, 20202, 20201] |

## 注意事项

1. 使用本工具需要有有效的Fofa API凭证，免费账号有调用次数限制
2. 大量请求可能会消耗较多的API调用额度，请合理使用
3. 建议根据您的系统性能调整线程数，避免资源占用过高
4. 代理的有效性会随着时间变化，建议定期更新代理列表
5. 本工具仅用于学习和研究目的，请遵守相关法律法规

## 常见问题

### 1. 运行时提示"Fofa API调用失败"怎么办？
- 检查您的Fofa API凭证是否正确
- 检查您的网络连接是否正常
- 检查您的Fofa账号是否有足够的API调用额度

### 2. 收集到的代理数量很少怎么办？
- 尝试修改Fofa搜索语法，使用更广泛的搜索条件
- 增加搜索页数（默认为前5页）
- 扩大端口扫描范围

### 3. 验证后的有效代理为什么很少？
- 免费代理的稳定性和可用性通常较低
- 可以尝试调整超时时间，增加验证时间
- 可以添加更多的测试URL，提高验证准确性

## 更新日志

### v1.0
- 初始版本，实现基本的代理收集和验证功能

### v1.1
- 增加多URL测试功能
- 优化代理验证逻辑
- 增加统计报告功能

### v1.2
- 添加用户和密码字典认证功能
- 优化并发处理性能
- 增加批处理启动脚本

## 免责声明

本工具仅供学习和研究使用，请勿用于任何非法用途。使用本工具产生的一切后果由使用者自行承担。